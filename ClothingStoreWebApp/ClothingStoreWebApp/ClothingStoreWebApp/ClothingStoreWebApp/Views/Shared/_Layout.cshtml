    @using ClothingStoreWebApp.Helpers
    @{
        Layout = null;
        var isLoggedIn = Session["IsLoggedIn"] as bool? == true;
    }
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="utf-8" />
        <title>@ViewBag.Title - Clothing Store</title>
        <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
        <style>
            .navbar-brand {
                font-weight: bold;
                font-size: 1.5rem;
            }

            .cart-badge {
                position: absolute;
                top: -8px;
                right: -8px;
                min-width: 18px;
                height: 18px;
                border-radius: 50%;
                font-size: .75rem;
                line-height: 18px;
                text-align: center;
            }

            .cart-link {
                position: relative;
                display: inline-block;
            }

            body {
                display: flex;
                flex-direction: column;
                min-height: 100vh;
            }

            main {
                flex: 1;
                padding: 20px 0;
            }

            footer {
                background: #343a40;
                color: #fff;
                padding: 20px 0;
            }
        </style>
    </head>
    <body>
        @Html.AntiForgeryToken()
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
            <div class="container-fluid">
                <a class="navbar-brand" href="@Url.Action("Index", "Home")">
                    <i class="fas fa-store"></i>
                    Clothing Store
                </a>

                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="@Url.Action("Index", "Home")">
                                <i class="fas fa-home"></i> Trang chủ
                            </a>
                        </li>

                        @* ✅ PRODUCTS LINK *@
                        <li class="nav-item">
                            <a class="nav-link" href="@Url.Action("Index", "Product")">
                                <i class="fas fa-tshirt"></i> Sản phẩm
                            </a>
                        </li>

                        @* ✅ CATEGORIES LINK *@
                        <li class="nav-item">
                            <a class="nav-link" href="@Url.Action("List", "Category")">
                                <i class="fas fa-th-large"></i> Danh mục
                            </a>
                        </li>

                        @* ✅ BRANDS LINK  *@
                        <li class="nav-item">
                            <a class="nav-link" href="@Url.Action("List", "Brand")">
                                <i class="fas fa-tags"></i> Thương hiệu
                            </a>
                        </li>
                        @* Admin Management Link *@
                        @{
                            var userRoles = Session["UserRoles"] as List<string>;
                            bool isAdmin = userRoles != null && userRoles.Contains("Admin");
                        }

                        @if (isAdmin)
                        {
                            <li class="nav-item ms-2">
                                <a class="nav-link text-warning" href="@Url.Action("Index", "Admin")" title="Trang Quản Lý Admin">
                                    <i class="fas fa-tools me-1"></i> Quản Lý
                                </a>
                            </li>
                        }

                        @* Admin Dashboard Link *@
                        @if (Session["Role"] != null && Session["Role"].ToString() == "Admin")
                        {
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="adminDropdown" role="button" data-bs-toggle="dropdown">
                                    <i class="fas fa-user-shield"></i> Admin
                                </a>
                                <ul class="dropdown-menu" aria-labelledby="adminDropdown">
                                    <li>
                                        <a class="dropdown-item" href="@Url.Action("Index", "Admin")">
                                            <i class="fas fa-tachometer-alt"></i> Dashboard
                                        </a>
                                    </li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li>
                                        <a class="dropdown-item" href="@Url.Action("Manage", "Category")">
                                            <i class="fas fa-th-large"></i> Quản lý Danh mục
                                        </a>
                                    </li>
                                    <li>
                                        <a class="dropdown-item" href="@Url.Action("Manage", "Brand")">
                                            <i class="fas fa-tags"></i> Quản lý Thương hiệu
                                        </a>
                                    </li>
                                    <li>
                                        <a class="dropdown-item" href="@Url.Action("Index", "Admin")">
                                            <i class="fas fa-box"></i> Quản lý Sản phẩm
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        }
                    </ul>

                    @* Right side menu *@
                    <ul class="navbar-nav">
                        @* Cart *@
                        <li class="nav-item">
                            <a class="nav-link position-relative" href="@Url.Action("Index", "Cart")">
                                <i class="fas fa-shopping-cart"></i> Giỏ hàng
                                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="cart-count">
                                    0
                                </span>
                            </a>
                        </li>

                        @* User menu *@
                        @if (Session["IsLoggedIn"] as bool? == true)
                        {
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
                                    <i class="fas fa-user"></i> @Session["UserName"]
                                </a>
                                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                                    <li>
                                        <a class="dropdown-item" href="@Url.Action("Profile", "User")">
                                            <i class="fas fa-user-circle"></i> Tài khoản
                                        </a>
                                    </li>
                                    <li>
                                        <a class="dropdown-item" href="@Url.Action("Orders", "User")">
                                            <i class="fas fa-shopping-bag"></i> Đơn hàng
                                        </a>
                                    </li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li>
                                        <a class="dropdown-item" href="@Url.Action("Logout", "User")">
                                            <i class="fas fa-sign-out-alt"></i> Đăng xuất
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        }
                        else
                        {
                            <li class="nav-item">
                                <a class="nav-link" href="@Url.Action("Login", "User")">
                                    <i class="fas fa-sign-in-alt"></i> Đăng nhập
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="@Url.Action("Register", "User")">
                                    <i class="fas fa-user-plus"></i> Đăng ký
                                </a>
                            </li>
                        }
                    </ul>
                </div>
            </div>
        </nav>


        <main class="container-fluid">
            @RenderBody()
        </main>

        <footer>
            <div class="container">
                <div class="row">
                    <div class="col-md-6">
                        <h5>Clothing Store</h5>
                        <p>Your one-stop shop for fashion and style.</p>
                    </div>
                    <div class="col-md-3">
                        <h6>Quick Links</h6>
                        <ul class="list-unstyled">
                            <li>@Html.ActionLink("Home", "Index", "Home", null, new { @class = "text-light" })</li>
                            <li>@Html.ActionLink("Products", "Index", "Product", null, new { @class = "text-light" })</li>
                            <li>@Html.ActionLink("Categories", "Index", "Category", null, new { @class = "text-light" })</li>
                        </ul>
                    </div>
                    <div class="col-md-3">
                        <h6>Account</h6>
                        <ul class="list-unstyled">
                            @if (isLoggedIn)
                            {
                                <li>@Html.ActionLink("My Cart", "Index", "Cart", null, new { @class = "text-light" })</li>
                                <li>@Html.ActionLink("Logout", "Logout", "User", null, new { @class = "text-light" })</li>
                            }
                            else
                            {
                                <li>@Html.ActionLink("Login", "Login", "User", null, new { @class = "text-light" })</li>
                                <li>@Html.ActionLink("Register", "Register", "User", null, new { @class = "text-light" })</li>
                            }
                        </ul>
                    </div>
                </div>
                <hr class="bg-light" />
                <div class="text-center">&copy; @DateTime.Now.Year Clothing Store. All rights reserved.</div>
            </div>
        </footer>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            $.ajaxSetup({
                beforeSend: function(xhr, settings) {
                    if (settings.type !== 'GET') {
                        var token = $('input[name="__RequestVerificationToken"]').val();
                        if (token) xhr.setRequestHeader("RequestVerificationToken", token);
                    }
                }
            });
            $(function(){
                if (@(isLoggedIn.ToString().ToLower())) {
                    $.get('@Url.Action("GetCartCount","Cart")', function(res){
                        $('#cart-count-badge').text(res.cartCount).toggle(res.cartCount>0);
                    });
                }
            });
        </script>
        @RenderSection("Scripts", required: false)
    </body>
    </html>
    